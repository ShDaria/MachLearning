Под временным рядом понимаются последовательно измеренные через некоторые (зачастую равные) промежутки времени данные.  
Ряд yt называется слабо стационарным (weak stationarity) или стационарным в широком смысле, если такие статистические характеристики
временного ряда как его математическое ожидание (среднее), дисперсия (ср. кв. отклонение) и ковариация не зависят от момента времени
E[y] = Const, D[y] = Const, Cov[yk, y(k-1)] = R(k)  
Если нарушается хотя бы одно из этих условий, то ряд называется нестационарным.

Скользящая средняя (Moving Average - MA) - среднее арифметическое значений исходной функции за установленный период. Скользящие средние позволяют сгладить как случайные, так и периодические колебания, выявить имеющуюся тенденцию в развитии процесса.

### Тест Дики-Фуллера
*Тест Дики-Фуллера* используется для проверки ряда на стационарность. Он проверяет ряд на наличие так называемых единичных корней.
Временной ряд имеет *единичный корень* (хотя бы один), если его первые разности образуют стационарный ряд.

*Обозн.* y(t) ~ I(1), т.е. Δy(t)=y(t)-y(t-1) ~ I(0), где Δ - разностный оператор, I(j) - означает, что ряд является интегрированным порядка j, I(0) - ряд стационарен.
Временной ряд называется *интегрированным порядка `k`*, если разности ряда k-го порядка `Δ^k x(t)` являются стационарными, а разности меньшего порядка (и сам временной ряд) не являются стационарными рядами.
* Δ yk   = y(k+1) - yk
* Δ^2 yk = Δ y(k+1) - Δ yk = y(k+2) - 2y(k+1) + yk
* Δ^m yk = Δ^m-1 y(k+1) - Δ^m-1 yk, где Δ - разностный оператор

*Обозн.* yk ~ I(k) - интегрированный временной ряд порядка k

Вообще говоря, тест Дики-Фуллера проверяет значение коэффициента `a` в авторегрессионном уравнении 1-го порядка. Оно имеет вид:

y(t) = a * y(t-1) + ε(t), ε(t) - ошибка
* a=1   => есть единичные корни => стационарности нет
* |a|<1 => нет единичных корней => есть стационарность
* |a|>1 => не свойственно для временных рядов, которые встречаются в реальной жизни - требуется более сложный анализ

Преобразуем уравнение:

y(t) = a * y(t-1) + ε(t)
y(t) - y(t-1) = a * y(t-1) - y(t-1) + ε(t)
Δy(t) = (a-1) * y(t-1) + ε(t)
**Δy(t) = b * y(t-1) + ε(t)**, где b=a-1

Сформулируем основную и альтернативную гипотезы:
* Основная гипотеза: H0: b=0 - существует единичный корень, ряд нестационарный.
* Альтернативаная гипотеза: H1: b<0 - единичного корня нет, ряд стационарный

Для того чтобы проверить временной ряд y на порядок интегрируемости, следует рассчитать значение t-статистики Стьюдента для
параметра b и сравнить его с верхним и нижним критическими значениями DF-статистики из таблицы теста Дики-Фуллера. Если для n наблюдений
значение расчетной t-статистики sm.tsa.adfuller(ts) меньше, чем нижнее критическое значение, нулевую гипотезу b=0 отклоняют и принимают альтернативную о стационарности процесса yt. В противном случае, нулевая гипотеза не может быть отклонена. Если нулевая гипотеза не отклоняется, можно лишь утверждать, что процесс yt нестационарен, т.е. либо он интегрируем более высокого порядка, либо неинтегрируем вообще.

### Тренд, сезональность, остаток. Аддитивная и мультипликативная модели

*Трендовая* составляющая отражает влияние долговременных факторов и соответствует устойчивой и долговременной тенденции изменения временного ряда.
*Сезонная* компонента s(τ i) связана с наличием факторов, действующих с заранее известной периодичностью. Это регулярные колебания, которые носят периодический или близкий к нему характер.
*Остатком* временного ряда называется разница между предсказанным и наблюдаемым значением.

* Общий вид *аддитивной модели*: Y = T + S + E;
* Общий вид *мультипликативной модели*: Y = T * S * E;
* T - тренд, S - сезональность, E - остаток
### Преобразование Бокса-Кокса
Попробуем применить преобразование, чтобы приблизить имеющееся распределение к нормальному. Будем использовать преобразование Бокса-Кокса (логарифмирование – это частный случай трансформации Бокса-Кокса) 
y_new=(y^p−1)/p , если p≠0 
y_new=ln(y), если p=0

### ARIMA и SARIMAX
  *Авторегрессионная (AR-) модель (англ. autoregressive model) — модель временных рядов, в которой значения временного ряда в данный момент линейно зависят от предыдущих значений этого же ряда. Авторегрессионный процесс порядка p (AR(p)-процесс) определяется следующим образом  
  Y_t = c + Σ(from i=1 to p)a_i * X_(t-i) + e_t, где a_i - параматеры модели (коэффициенты авторегрессии), c — постоянная
  
  *MA (moving average model) - модель скользящего среднего, в которой моделируемый уровень временного ряда можно представить как линейную функцию прошлых ошибок, т.е. разностей между прошлыми фактическими и теоретическими уровнями.  
  Y_t = Σ(from j=0 to q)b_j * e_(t-j), где b_j - параматеры модели  
  
  *ARIMA (англ. autoregressive integrated moving average)*- интегрированная модель авторегрессии — скользящего среднего — модель и методология анализа временных рядов.  
ARIMA(p, d, q), где p - порядок AR(p), d - порядок интегрированности, q - порядок MA(q)  
Δ^d(Y_t) = c + Σ(from i=1 to p) * a_i * Δ^d(Y_(t-1)) + Σ(from j=1 to q)b_j * e_(t-j)
  
*SARIMAX* - модель временных рядов, построенная на основе расширенной (eXtended) модели ARIMA с добавлением сезонности (Seasonal).
Здесь аргумент order устанавливает параметры  (p, d, q), в то время как seasonal_order определяет параметры (P, D, Q, S).



### Библиотеки и функции
* statsmodels - представляет собой пакет Python, который позволяет пользователям исследовать данные, оценивать статистические модели и выполнять статистические тесты;
   * statsmodels.tsa.stattools.acf(x, unbiased=False, nlags=40, ...) строит график автокорреляции ряда x;
   * statsmodels.tsa.stattools.pacf(x, nlags=40, method='ywunbiased', ...) строит график частичной автокорреляции ряда x; nlags - число лагов
   * statsmodels.tsa.seasonal.seasonal_decompose(x, model='additive', разложение временного ряда х на сезонность, тренд и остаток в соответсвии с заданной моделью model; model : str {“additive”, “multiplicative”}
   * statsmodels.tsa.stattools.adfuller(x, ...) - тест Дики-Фулера для ряда x;
   * statsmodels.tsa.arima_model.ARIMA(х, order, ...) построение модели ARIMA с параметрами order; order=(p, d, q)
   * statsmodels.tsa.statespace.sarimax.SARIMAX(х, order, seasonal_order, ...) построение модели SARIMA с параметрами order и сезонными параметрами seasonal_order;
* scipy.stats.boxcox(x, lmbda,...) - Трансформация Бокса — Кокса (Box-Cox transformation)
* sklearn - инструменты для машинного обучения и анализа данных;
   * r2_score(true, pred) функция регрессионной оценки с истинными значениями true и предсказнными pred;


